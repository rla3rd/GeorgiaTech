{"version":"NotebookV1","origId":2129793489833417,"name":"q2","language":"scala","commands":[{"version":"CommandV1","origId":2129793489833418,"guid":"9443cef0-02a4-40c5-acb1-975c77937e92","subtype":"command","commandType":"auto","position":1.0,"command":"// Q2 [25 pts]: Analyzing a Large Graph with Spark/Scala on Databricks\n\n// STARTER CODE - DO NOT EDIT THIS CELL\nimport org.apache.spark.sql.functions.desc\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types._\nimport spark.implicits._","commandVersion":60,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1570233488886,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"vsrivastava43@gatech.edu","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"f97c106a-5937-4434-aeb4-148622ceb869"},{"version":"CommandV1","origId":2129793489833419,"guid":"bdaad185-78e3-4e22-b982-6da4052ad96f","subtype":"command","commandType":"auto","position":1.5,"command":"// STARTER CODE - DO NOT EDIT THIS CELL\n// Definfing the data schema\nval customSchema = StructType(Array(StructField(\"answerer\", IntegerType, true), StructField(\"questioner\", IntegerType, true),\n    StructField(\"timestamp\", LongType, true)))","commandVersion":20,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1570233489630,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"vsrivastava43@gatech.edu","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"f29b5ca3-af6d-4877-a1de-40fccae0a72a"},{"version":"CommandV1","origId":2129793489833421,"guid":"a49f2a9c-043a-4604-8eaf-664b93415d2e","subtype":"command","commandType":"auto","position":2.0,"command":"// STARTER CODE - YOU CAN LOAD ANY FILE WITH A SIMILAR SYNTAX.\n// MAKE SURE THAT YOU REPLACE THE examplegraph.csv WITH THE mathoverflow.csv FILE BEFORE SUBMISSION.\nval df = spark.read\n   .format(\"com.databricks.spark.csv\")\n   .option(\"header\", \"false\") // Use first line of all files as header\n   .option(\"nullValue\", \"null\")\n   .schema(customSchema)\n   .load(\"/FileStore/tables/examplegraph.csv\")\n   .withColumn(\"date\", from_unixtime($\"timestamp\"))\n   .drop($\"timestamp\")","commandVersion":242,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1570233493345,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"vsrivastava43@gatech.edu","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"5d131f4d-d190-411d-80b0-709e47cc4f67"},{"version":"CommandV1","origId":2129793489833422,"guid":"04cb6cea-c1bc-437f-8b04-89b6c09e5084","subtype":"command","commandType":"auto","position":2.5,"command":"//display(df)\ndf.show()","commandVersion":6,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1570233497854,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"285","xColumns":["date"],"yColumns":["month"],"pivotColumns":[],"pivotAggregation":"sum","useConsistentColors":false,"customPlotOptions":{"barChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"vsrivastava43@gatech.edu","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"79a20d6a-8554-4949-a390-700e9d7d02dd"},{"version":"CommandV1","origId":2129793489833423,"guid":"711210ff-ceb9-483e-bb48-d3de2509741f","subtype":"command","commandType":"auto","position":2.625,"command":"// PART 1: Remove the pairs where the questioner and the answerer are the same person.\n// ALL THE SUBSEQUENT OPERATIONS MUST BE PERFORMED ON THIS FILTERED DATA\n\n// ENTER THE CODE BELOW\n","commandVersion":38,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1567828766327,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"vsrivastava43@gatech.edu","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"2c11bfeb-d4c0-4de2-90ca-df375fb907c2"},{"version":"CommandV1","origId":2129793489833424,"guid":"b0c908d2-5f35-4dbe-964e-2db97fc4a556","subtype":"command","commandType":"auto","position":2.75,"command":"// PART 2: The top-3 individuals who answered the most number of questions - sorted in descending order - if tie, the one with lower node-id gets listed first : the nodes with the highest out-degrees.\n\n// ENTER THE CODE BELOW\n","commandVersion":53,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1567828766328,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"vsrivastava43@gatech.edu","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"fed4b9f1-a0ba-4243-b4a8-5a5f0c15ea57"},{"version":"CommandV1","origId":2129793489833425,"guid":"e4a755d0-6593-412d-9cf5-26a40bd7f5fb","subtype":"command","commandType":"auto","position":2.875,"command":"// PART 3: The top-3 individuals who asked the most number of questions - sorted in descending order - if tie, the one with lower node-id gets listed first : the nodes with the highest in-degree.\n\n// ENTER THE CODE BELOW\n","commandVersion":31,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1567828766329,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"vsrivastava43@gatech.edu","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"79be0901-32da-4280-afa9-886dfbda2019"},{"version":"CommandV1","origId":2129793489833426,"guid":"3f91e2de-3ca1-4986-98fe-73e0050a9877","subtype":"command","commandType":"auto","position":2.9375,"command":"// PART 4: The top-5 most common asker-answerer pairs - sorted in descending order - if tie, the one with lower value node-id in the first column (u->v edge, u value) gets listed first.\n\n// ENTER THE CODE BELOW\n","commandVersion":17,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1567828766329,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"vsrivastava43@gatech.edu","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"2a923092-83d4-4092-a0c6-86dc2107ac9c"},{"version":"CommandV1","origId":2129793489833427,"guid":"467151f9-08e9-46c9-a159-f6adae81fd09","subtype":"command","commandType":"auto","position":2.96875,"command":"// PART 5: Number of interactions (questions asked/answered) over the months of September-2010 to December-2010 (i.e. from September 1, 2010 to December 31, 2010). List the entries by month from September to December.\n\n// Reference: https://www.obstkel.com/blog/spark-sql-date-functions\n// Read in the data and extract the month and year from the date column.\n// Hint: Check how we extracted the date from the timestamp.\n\n// ENTER THE CODE BELOW\n","commandVersion":160,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1567828766330,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"vsrivastava43@gatech.edu","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"4c24126c-3736-4dc1-9232-f5b82c280ba9"},{"version":"CommandV1","origId":2129793489833428,"guid":"103f7b3b-58c1-44c5-8a26-12689d5b8ad1","subtype":"command","commandType":"auto","position":8.0,"command":"// PART 6: List the top-3 individuals with the maximum overall activity, i.e. total questions asked and questions answered.\n\n// ENTER THE CODE BELOW\n","commandVersion":72,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1567828766331,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"vsrivastava43@gatech.edu","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"21b70504-41cb-4431-9a14-9739c13032ab"}],"dashboards":[],"guid":"af305679-314d-40df-ae1e-e3d4bd8e2c26","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}